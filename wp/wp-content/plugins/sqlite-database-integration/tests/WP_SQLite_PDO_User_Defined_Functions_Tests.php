<?php

use PHPUnit\Framework\TestCase;

class WP_SQLite_PDO_User_Defined_Functions_Tests extends TestCase {

	/**
	 * @covers WP_SQLite_PDO_User_Defined_Functions::field
	 * @dataProvider dataProviderForTestFieldFunction
	 */
	public function testFieldFunction( $expected, $args ) {
		$pdo_class = PHP_VERSION_ID >= 80400 ? PDO\SQLite::class : PDO::class;
		$pdo       = new $pdo_class( 'sqlite::memory:' );
		$fns       = WP_SQLite_PDO_User_Defined_Functions::register_for( $pdo );

		$this->assertEquals(
			$expected,
			$fns->field( ...$args )
		);
	}

	public static function dataProviderForTestFieldFunction() {
		return array(
			array( 1, array( 'a', 'a' ) ),
			array( 2, array( 'User 0000019', 'User 0000018', 'User 0000019', 'User 0000020' ) ),
		);
	}
}
